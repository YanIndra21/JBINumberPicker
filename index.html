<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Jegeg Bagus INSTIKI</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800;900&display=swap" rel="stylesheet">
    <style>
      :root {
        --bg-red-1: #b20c0c;
        --bg-red-2: #e31a1a;
        --gold-1: #ffe08a;
        --gold-2: #d9a431;
        --gold-3: #bb8226;
        --white: #ffffff;
        /* Variabel responsif agar selalu muat di viewport dan simetris */
        --card-size: clamp(140px, 20vmin, 260px);
        --grid-gap: clamp(18px, 4vmin, 56px);
        --pill-bottom: clamp(10px, 1.6vmin, 16px);
        /* Margin kiri-kanan tetap 8 cm */
        --side-margin: 8cm;
        /* Kalibrasi ukuran & jarak via script */
        --gap-ratio: 0.12;   /* jarak dibanding lebar kartu (lebih kecil agar kartu bisa membesar) */
        --density: 1.00;     /* seberapa rapat memanfaatkan ruang */
        --card-min: 140;     /* px, batas bawah di script */
        --card-max: 340;     /* px, batas atas di script */
        --card-target: 250;  /* px, target kartu jika memungkinkan */
        /* Margin bawah tambahan agar ada ruang di kaki layar */
        --bottom-space: clamp(28px, 4vmin, 64px);
      }

      * { box-sizing: border-box; }
      html, body { height: 100%; }
      body {
        margin: 0;
        font-family: 'Montserrat', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
        color: var(--white);
        background: #000; /* video akan menjadi latar sesungguhnya */
        overflow: hidden; /* nonaktifkan scroll vertical */
        overscroll-behavior: none;
      }

      /* Video background */
      .bg-video {
        position: fixed;
        inset: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        z-index: -1; /* berada di belakang konten */
      }

      .wrap {
        max-width: 100vw;
        margin: 0 auto;
        padding: 0 var(--side-margin) var(--bottom-space);
        text-align: center;
        min-height: 100vh;
        display: grid;
        align-content: center; /* pusatkan vertikal */
        justify-content: center; /* pusatkan horizontal */
      }

      /* Top badges pill menggunakan gambar */
      .pill-img {
        /* Lebar mengikuti gambar referensi dan tetap responsif */
        width: clamp(300px, 14vmin, 300px);
        height: auto;
        display: block;
        margin: 0 auto var(--pill-bottom);
        filter: drop-shadow(0 10px 18px #00000055);
        border-radius: 999px;
      }

      .grid {
        display: grid;
        grid-template-columns: repeat(5, var(--card-size));
        gap: var(--grid-gap);
        justify-content: center;
        justify-items: center;
        align-items: start;
      }

      .card {
        position: relative;
        width: 100%;
        aspect-ratio: 1 / 1; /* gambar kamu square */
        border-radius: clamp(18px, 2.5vw, 22px);
        overflow: hidden; /* pastikan lekukan sudut memotong gambar */
        /* gambar per kartu akan dipasang inline via style */
        background-color: transparent;
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        box-shadow: 0 clamp(8px, 2vw, 14px) clamp(18px, 3vw, 28px) #00000035;
        display: grid;
        place-items: center;
        isolation: isolate;
      }

      .card.hidden {
        /* Tetap mempertahankan slot grid agar barisan tidak bergeser */
        visibility: hidden;
        opacity: 0;
        pointer-events: none;
      }

      .overlay {
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.35);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 50;
        backdrop-filter: blur(2px);
      }
      .overlay.show { display: flex; }
      .overlay-card {
        width: clamp(320px, 46vmin, 560px);
        aspect-ratio: 1 / 1;
        border-radius: clamp(18px, 2.5vw, 22px);
        background-size: cover;
        background-position: center;
        box-shadow: 0 18px 32px #00000055;
      }

      /* Indikator ukuran viewport untuk debugging */
     

      /* === ANIMASI RANDOM PICK === */
      .card.dim {
        filter: brightness(0.55) saturate(0.8);
        transition: filter 0.2s ease;
      }

      .card.spotlight {
        filter: brightness(1.15) saturate(1.2);
        box-shadow:
          0 0 0 6px rgba(255, 215, 100, 0.25),
          0 0 40px rgba(255, 215, 100, 0.85);
        transform: scale(1.04);
        transition: all 0.25s ease;
        z-index: 5;
      }


      /*Timer style*/
      .timer {
        font-size: 200px;
        font-weight: 900;
        margin: 18px 0 24px;
        color: #ffe08a;
        text-shadow: 0 0 18px rgba(255, 215, 100, 0.6);
        transition: opacity 0.3s ease, transform 0.3s ease;
      }

      .timer.hidden {
        opacity: 0;
        transform: translateY(-10px);
        pointer-events: none;
      }
   .timer-wrapper {
  margin-top: 12px;
  margin-bottom: 18px;
  transition: margin 0.3s ease, opacity 0.3s ease;
}

.timer-wrapper.hidden {
  opacity: 0;
  margin-top: 0;
  margin-bottom: 0;
  pointer-events: none;
}


.reset-btn {
  padding: 8px 18px;
  font-size: 14px;
  font-weight: 800;
  border-radius: 10px;
  border: none;
  cursor: pointer;
  background: linear-gradient(180deg, #ffe08a, #d9a431);
  color: #5c3b00;
  box-shadow: 0 6px 14px rgba(0,0,0,0.35);
}

.reset-btn.hidden {
  display: none;
}
/* Jarak normal (rapat) */
.wrap {
  display: flex;
  flex-direction: column;
  align-items: center;
}

/* Saat timer aktif, pusat bergeser ke atas */
.wrap.timer-active {
  align-content: start;
}


.wrap.timer-active {
  padding-top: clamp(32px, 6vmin, 72px);
}

.timer-overlay {
  position: fixed;
  inset: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 18px;

  background: rgba(0, 0, 0, 0.50);
  backdrop-filter: blur(2px);

  opacity: 0;
  pointer-events: none;
  transition: opacity 0.35s ease;
  z-index: 40;
}

.timer-overlay.show {
  opacity: 1;
  pointer-events: auto;
}

.timer-float {
  font-size: clamp(64px, 8vmin, 110px);
  font-weight: 900;
  color: #ffe08a;
  text-shadow:
    0 0 20px rgba(255, 215, 100, 0.7),
    0 0 40px rgba(255, 180, 80, 0.4);
}



      /* tidak perlu ornamen terpisah karena sudah menyatu di gambar */

      /* angka manual dihapus karena sudah ada di gambar */

      /* Layout tweaks for smaller screens */
      @media (max-width: 1024px) {
        .grid { grid-template-columns: repeat(4, var(--card-size)); }
      }
      @media (max-width: 768px) {
        .grid { grid-template-columns: repeat(3, var(--card-size)); }
      }
      @media (max-width: 560px) {
        .grid { grid-template-columns: repeat(2, var(--card-size)); }
      }
      @media (max-width: 360px) {
        .grid { grid-template-columns: 1fr; }
      }


      @keyframes pulseSlow {
  0% { transform: scale(1); }
  50% { transform: scale(1.06); }
  100% { transform: scale(1); }
}

@keyframes pulseMedium {
  0% { transform: scale(1); }
  50% { transform: scale(1.12); }
  100% { transform: scale(1); }
}

@keyframes pulseFast {
  0% { transform: scale(1); }
  50% { transform: scale(1.2); }
  100% { transform: scale(1); }
}

.timer-float.pulse-30 {
  animation: pulseSlow 1.2s infinite;
}

.timer-float.pulse-15 {
  animation: pulseMedium 0.8s infinite;
}

.timer-float.pulse-5 {
  animation: pulseFast 0.4s infinite;
}

.timer-float.finish {
  animation: none !important;
  transform: scale(1.35);
  color: #ff6b6b;
}

    </style>
  </head>
  <body>
    <!-- Video latar: ganti src ke file video kamu -->
    <video class="bg-video" autoplay muted loop playsinline>
      <source src="assets/bg.mp4" type="video/mp4" />
    </video>
    

    <div class="wrap">
      <!-- Gambar pill header yang kamu kirim -->
      <img class="pill-img" src="assets/pill.png" alt="Header badges" />

<div id="timerOverlay" class="timer-overlay">
  <div id="timer" class="timer-float">45</div>
</div>



      <div class="grid" role="list" aria-label="Pilihan 1 sampai 20">
        <div class="card" role="listitem" data-number="1" style="background-image:url('assets/1.png')"></div>
        <div class="card" role="listitem" data-number="2" style="background-image:url('assets/2.png')"></div>
        <div class="card" role="listitem" data-number="3" style="background-image:url('assets/3.png')"></div>
        <div class="card" role="listitem" data-number="4" style="background-image:url('assets/4.png')"></div>
        <div class="card" role="listitem" data-number="5" style="background-image:url('assets/5.png')"></div>
        <div class="card" role="listitem" data-number="6" style="background-image:url('assets/6.png')"></div>
        <div class="card" role="listitem" data-number="7" style="background-image:url('assets/7.png')"></div>
        <div class="card" role="listitem" data-number="8" style="background-image:url('assets/8.png')"></div>
        <div class="card" role="listitem" data-number="9" style="background-image:url('assets/9.png')"></div>
        <div class="card" role="listitem" data-number="10" style="background-image:url('assets/10.png')"></div>

      </div>
      <div id="overlay" aria-hidden="true" class="overlay" role="dialog">
        <div id="overlayCard" class="overlay-card" aria-label="Kartu besar"></div>
      </div>
      <!-- <div id="debugSize" class="debug-size" aria-live="polite" title="Ukuran viewport dan area konten"></div> -->
      
  </div>
  <script>
    (function() {
      // --- Responsif: pastikan 20 kotak selalu muat tanpa scroll ---
      const wrap = document.querySelector('.wrap');
      const pill = document.querySelector('.pill-img');
      const debugEl = document.getElementById('debugSize');
      const rootStyle = document.documentElement.style;
      const css = getComputedStyle(document.documentElement);
      const GAP_RATIO = parseFloat(css.getPropertyValue('--gap-ratio')) || 0.24; // gap relatif thd ukuran kartu
      const DENSITY = parseFloat(css.getPropertyValue('--density')) || 0.96; // tingkat pemanfaatan ruang
      const CARD_MIN = parseFloat(css.getPropertyValue('--card-min')) || 120; // px
      const CARD_MAX = parseFloat(css.getPropertyValue('--card-max')) || 280; // px
      const CARD_TARGET = parseFloat(css.getPropertyValue('--card-target')) || null; // target kartu

      function fitGrid() {
        const cols = 5, rows = 4;
        // Lebar tersedia adalah konten .wrap (tanpa padding kiri/kanan 8 cm)
        let availW = window.innerWidth;
        if (wrap) {
          const wrapStyles = getComputedStyle(wrap);
          const pl = parseFloat(wrapStyles.paddingLeft) || 0;
          const pr = parseFloat(wrapStyles.paddingRight) || 0;
          // clientWidth sudah termasuk padding; kurangi agar hanya area konten
          availW = wrap.clientWidth - pl - pr;
        }
        const pillRect = pill ? pill.getBoundingClientRect() : { height: 0 };
        const pillStyles = pill ? getComputedStyle(pill) : { marginBottom: '0' };
        const pillBottom = parseFloat(pillStyles.marginBottom) || 0;
        const bottomSpace = parseFloat(css.getPropertyValue('--bottom-space')) || 0;
        const availH = window.innerHeight - pillRect.height - pillBottom - bottomSpace;

        // Rumus: card * (cols + (cols-1)*GAP_RATIO) <= availW
        const cardByWidth = (availW * DENSITY) / (cols + (cols - 1) * GAP_RATIO);
        const cardByHeight = (availH * DENSITY) / (rows + (rows - 1) * GAP_RATIO);
        let card = Math.min(cardByWidth, cardByHeight, CARD_MAX);
        if (CARD_TARGET) card = Math.min(card, CARD_TARGET);
        card = Math.max(CARD_MIN, card);
        const gap = Math.max(20, Math.min(card * GAP_RATIO, 80));

        rootStyle.setProperty('--card-size', `${Math.floor(card)}px`);
        rootStyle.setProperty('--grid-gap', `${Math.floor(gap)}px`);

        // Tampilkan ukuran untuk kamu lihat
        if (debugEl) {
          const vpW = window.innerWidth;
          const vpH = window.innerHeight;
          const info = `viewport: ${vpW}×${vpH}\nkonten: ${Math.round(availW)}×${Math.round(availH)}\ncard: ${Math.round(card)} gap: ${Math.round(gap)}`;
          debugEl.textContent = info;
        }
      }

      window.addEventListener('resize', fitGrid);
      window.addEventListener('load', fitGrid);
      fitGrid();
      const overlay = document.getElementById('overlay');
      const overlayCard = document.getElementById('overlayCard');
      const cards = Array.from(document.querySelectorAll('.card'));
      const cardMap = new Map(cards.map(el => [Number(el.dataset.number), el]));

      const hidden = new Set();
      let overlayNumber = null;
      let lastPickedNumber = null;


      // Buffer untuk mendukung angka 2 digit (10-20)
      let digitBuffer = '';
      let bufferTimer = null;
      const BUFFER_MS = 450;

      function setOverlay(number) {
        overlayNumber = number;
        overlayCard.style.backgroundImage = `url('assets/${number}.png')`;
        overlay.classList.add('show');
        overlay.setAttribute('aria-hidden', 'false');
      }
      function closeOverlay() {
  overlayNumber = null;
  overlay.classList.remove('show');
  overlay.setAttribute('aria-hidden', 'true');

}

      function refreshHidden() {
        cardMap.forEach((el, num) => {
          el.classList.toggle('hidden', hidden.has(num));
        });
      }

      function triggerNumber(n) {
        if (!cardMap.has(n)) return; // guard

        if (overlayNumber === null) {
          if (hidden.has(n)) {
            hidden.delete(n); // kembalikan kartu ke barisan
            refreshHidden();
          } else {
            setOverlay(n); // tampilkan besar
          }
        } else {
          if (overlayNumber === n) {
            closeOverlay();
            hidden.add(n); // sembunyikan dari barisan
            refreshHidden();
          } else {
            setOverlay(n); // ganti kartu besar jika angka berbeda
          }
        }
      }

      function commitBuffer() {
        if (!digitBuffer) return;
        const n = Number(digitBuffer);
        digitBuffer = '';
        if (Number.isInteger(n) && n >= 1 && n <= 20) {
          triggerNumber(n);
        }
      }

      function handleDigit(key) {
        // key berupa string '0'..'9'
        digitBuffer += key;
        clearTimeout(bufferTimer);
        bufferTimer = setTimeout(commitBuffer, BUFFER_MS);
      }

      window.addEventListener('keydown', (e) => {

     if (e.code === 'Space') {
  e.preventDefault();
  togglePauseTimer();
}

if (e.key.toLowerCase() === 't') {
  startTimer();
}


if (e.key.toLowerCase() === 'p') {
  resetAndCloseTimer();
}


        if (e.key === 'Enter') {
          if (lastPickedNumber !== null) {
              hidden.add(lastPickedNumber);   // sembunyikan kartu
              refreshHidden();                // update grid
              closeOverlay();                 // tutup overlay
              lastPickedNumber = null;        // reset
          }
           startRandomPick();
        }

        // Abaikan jika ada modifier
        if (e.altKey || e.ctrlKey || e.metaKey) return;
        
        if (e.key >= '0' && e.key <= '9') {
          handleDigit(e.key);
          return;
        }

        if (e.code && e.code.startsWith('Numpad')) {
          const d = e.code.replace('Numpad', '');
          if (d >= '0' && d <= '9') {
            handleDigit(d);
            return;
          }
        }

      if (e.key === 'Escape') {
  if (lastPickedNumber !== null) {
    hidden.add(lastPickedNumber);
    refreshHidden();
    closeOverlay();

    showTimerReady(); // ✅ PENTING
    lastPickedNumber = null;
  }
}

      });

    /* ===============================
      RANDOM NUMBER PICK WITH ANIMATION
    ================================= */

    let rolling = false;
    let rollInterval = null;

    // Ambil kartu yang belum disembunyikan
    function getAvailableCards() {
      return cards.filter(c => !hidden.has(Number(c.dataset.number)));
    }

    function clearEffects() {
      cards.forEach(c => {
        c.classList.remove('spotlight', 'dim');
      });
    }

    function startRandomPick(duration = 1000) {
      if (rolling) return;
      rolling = true;

      const available = getAvailableCards();
      if (available.length === 0) return;

      // Gelapkan semua kartu
      cards.forEach(c => c.classList.add('dim'));

      let currentCard = null;

      rollInterval = setInterval(() => {
        if (currentCard) currentCard.classList.remove('spotlight');

        currentCard = available[Math.floor(Math.random() * available.length)];
        currentCard.classList.add('spotlight');
      }, 120);

      // Hentikan di angka terakhir
      setTimeout(() => {
        clearInterval(rollInterval);
        rolling = false;

        clearEffects();
        currentCard.classList.add('spotlight');

        const number = Number(currentCard.dataset.number);
        lastPickedNumber = number;


        // Tampilkan overlay besar (pakai fungsi kamu)
        setTimeout(() => {
          triggerNumber(number);
        }, 400);

      }, duration);
    }

    window.startRandomPick = startRandomPick;
   
  /* ===============================
   TIMER (SAMA DENGAN TIMER KHUSUS)
================================ */

const timerOverlay = document.getElementById('timerOverlay');
const timerEl = document.getElementById('timer');

let timerInterval = null;
let timeLeft = 45;
let timerRunning = false;
let timerPaused = false;

function showTimerReady() {
  timerOverlay.classList.add('show');
  timerEl.textContent = timeLeft;
  timerEl.style.transform = 'scale(1)';
}



function renderTimer() {
  timerEl.textContent = timeLeft;

  // WARNA BERDASARKAN SISA WAKTU
  if (timeLeft > 30) {
    timerEl.style.color = '#ffe08a'; // emas tenang
  } else if (timeLeft > 15) {
    timerEl.style.color = '#ffe08a'; // mulai panas
  } else if (timeLeft > 5) {
    timerEl.style.color = '#ffe08a'; // tegang
  } else {
    timerEl.style.color = '#ffe08a'; // kritis
  }
}


function startTimer() {
  if (timerRunning) return;

  timerRunning = true;
  timerPaused = false;
  timeLeft = 45;

  timerOverlay.classList.add('show');
  renderTimer();

  timerInterval = setInterval(() => {
    if (timerPaused) return;

    timeLeft--;
    renderTimer();

    if (timeLeft <= 0) {
      clearInterval(timerInterval);
      timerInterval = null;
      timerRunning = false;
    }
  }, 1000);
}

function togglePauseTimer() {
  if (!timerRunning) return;
  timerPaused = !timerPaused;
}

function resetTimer() {
  clearInterval(timerInterval);
  timerInterval = null;

  timeLeft = 45;
  timerRunning = false;
  timerPaused = false;

  renderTimer();
}
function resetAndCloseTimer() {
  // hentikan interval
  clearInterval(timerInterval);
  timerInterval = null;

  // reset state
  timerRunning = false;
  timerPaused = false;
  timerStopped = false;

  // reset waktu
  timeLeft = 45;
  timerEl.textContent = timeLeft;
  timerEl.style.color = '#ffe08a';
  timerEl.style.transform = 'scale(1)';

  // TUTUP overlay timer
  timerOverlay.classList.remove('show');
}

    
    })();
  </script>
  </body>
</html>
